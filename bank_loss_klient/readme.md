**Отток клиентов**  

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Постройте модель с предельно большим значением *F1*-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте *F1*-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте *AUC-ROC*, сравнивайте её значение с *F1*-мерой.  

**Итоговый вывод**  

**Подготовка данных**  
В оамках данного этапа:  
- категориальные признаки были преобразованы в численные по технике OHE  
- проведено масштабирование числовых признаковмасштабирование признаков   

**Иследование задачи**  
Поставленная задача относится к задачаи классификации, для ее решения были опробованы модели:  
- Decision Tree  
- Random forest  
- LogisticRegression  

**Борьба с дисбалансом**  
В целевом признаке был выявлен дисбаланс, количество ушедших клиентов к оставшимся относится в соотношении 1:4.  
Для борьбы с дисбалансом:  
- в моделях был использован парамметр class_weight='balanced'  
- в обучающей выборке значения положительного класса были увеличины до количества, премерно равного количеству значений отрицательного класса, методом upsampling  

По итогам проделанной работы наилучшие показатели оказались у модель случайный лес. Путем перебора наиболее значимых парамктров выяснилось, что наилучшие показатели модель обеспечивает с парамметрами max_depth=9 и n_estimators=40, дисбаланс устранен с помощью парамметра class_weight='balanced'.   
При данных параметрах значение F1-меры составляет 0.6  
Дополнительно была проверена метрика AUC-ROC, показавшая значение - 0.85 что существенно выше показателя 0.5 случайной модели. Данный уровегнь свидетельствет об адекватности модели и подтверждает ее качество.  

**Тестирование модели**  
На тестовой выборке модель также обеспечила высокие показатели:  
по метрике  F1- мера - 0.657  
по метрике AUC-ROC - 0.867  
по метрике recall - 0.72 

