**Определение стоимости автомобилей**  

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости. 

**Заказчику важны:**
- качество предсказания;
- скорость предсказания;
- время обучения.  

**План работ:**  
1.Подготовка данных.  
1.1. Загрузка и обзор данных.  
1.2. Изучение данных (Заполнение пропущенных значений, обработка аномалии в столбцах, удаление неинформативных признаков).  
1.3. Подготовка выборки для обучения моделей.  
2.Обучение моделей (одна из которых — LightGBM, как минимум одна — не бустинг).Для каждой модели подбор гиперпараметров.  
3.Анализ моделей (время обучения, время предсказания и качество моделей). Выбор лучшей модели, проверка её качество на тестовой выборке.  

**Примечания:**  
Для оценки качества моделей применяем метрику RMSE.  
Значение метрики RMSE должно быть меньше 2500.    

**Признаки**  
DateCrawled — дата скачивания анкеты из базы  
VehicleType — тип автомобильного кузова  
RegistrationYear — год регистрации автомобиля  
Gearbox — тип коробки передач  
Power — мощность (л. с.)  
Model — модель автомобиля  
Kilometer — пробег (км)  
RegistrationMonth — месяц регистрации автомобиля  
FuelType — тип топлива  
Brand — марка автомобиля  
NotRepaired — была машина в ремонте или нет  
DateCreated — дата создания анкеты  
NumberOfPictures — количество фотографий автомобиля  
PostalCode — почтовый индекс владельца анкеты (пользователя)  
LastSeen — дата последней активности пользователя  

**Целевой признак**  
Price — цена (евро)  

**Общий вывод**

**Загрузка и обзор данных**  
Представленый датасет содержит 15 признаков (включая целевой) и 354 369 записей.
В датасете содержится информация об автомобилях (250 моделей 40 брендов).
Цена авто в диапазоне от 0 до 20 000 евро, медиана - 2 700, средняя - 4 417.
Пробег от 5 000 до 150 000 км, при этом большая часть, более 50% имеют пробег 150 000 км.   
В пяти столбцах имеются пропущенные значения.
Часть признаков не информативна:
- почтовый индекс владельца анкеты (PostalCode).   
- столбец NumberOfPictures (количество фотографий автомобиля) содержит одни 0,    
- столбцы DateCrawled, DateCreated и LastSeen относятся к созданию анкеты, ее скачиванию и последней активности пользователя, что не имеет непосрдственного отношения к автомобилю  
- месяц регистрации (RegistrationMonth)   

**Изучение данных**  
В рамках данного этапа:
- выявлены и удалены дубликаты  
- удалены неинформативные признаки  
- в столбце Price удалены столбцы с неправдоподобно низкой ценой (менее 100 евро)  
- в столбцах VehicleType, Gearbox, Model, FuelType, Brand и NotRepaired пропущенные значения заменены на "unknown"  
- в столбце RegistrationYear удалены записи с годом регистрации авто менее 1950 и более 2023  
- в столбце Power нулевые значения заменены на медиану по соответствующей модели, после этого удалены аномальные и выбивающиеся значения (менее 45 л.с. и более 450 л.с.)    

**Подготовка выборки для обучения моделей**  
Сформированы переменные с признаками (без целевого) и с целевым признаком.  
Выборки разделены на обучающую и тестовую в пропорции 4 к 1   
Подготовлены списки категориальных и числовых признаков для кодирования и масштабирования.  
Непосредственно кодирование и масштабирование проведено в ходе обучения, поскольку для разных моделей используются разные подходы.   

**Обучение моделей**  
Обучено 4 модели: LinearRegression(), DecisionTreeRegressor(), LGBMRegressor() и CatBoostRegressor()  
По всем 4 моделям проведено обучение и подбор гипперпараметров, получены лучшие оценки по метрике RMSE.  
Модель LinearRegression() была заброкавана, так как у нее значение метрики RMSE выше макимально допустимого уровня в 2500, установленного заказщиком.  

**Анализ моделей**  
У модели DecisionTreeRegressor() лучшие показатели по времени предсказаний и обучения, но худшая из трех метрика качества. Наилучшая метрика качества у модели CatBoostRegressor(). У нее также немного более высокая скорость предсказания и существенно более высокая скорость обучения по сравнению с LGBMRegressor()
Учитывая совокупность показателей наиболее полно удовлетворяет требованиям заказчика модель -   
CatBoostRegressor(), качество выбранной модели - 1576, скрость предсказания - 1.97 с, время обучения - 52.4 с  
На тестовой выборке качество выбранной модели (метрика RMSE) сопоставимо с данными на тренировочной выборке (1563).  
  